<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>translate.service - admin</title>

  <link rel="stylesheet" href="./src/css/layui.css">
  <style>
    body {padding: 32px; /*overflow-y: scroll;*/}
    .translate-result-language-text-item{
      float:left;
      text-align:left;
          display: initial;
    }
    .layui-table-cell{
      overflow: inherit;
    }
  </style>
</head>
<body>


<script type="text/html" id="translate-result-td">
    <ul>
    {{#  layui.each(d.translateResult, function(index, item){ }}
      <li class="translate-result-language-text-item">
        <b>{{ item.language }}</b> &nbsp;:&nbsp;{{ item.text }}
        <button class="layui-btn layui-btn-xs" onclick="editTranslateText('{{ d.id }}', '{{ item.language }}', '{{ item.text }}')">
          <i class="layui-icon layui-icon-edit"></i>
        </button>
      </li>
    {{#  }); }}
    </ul>
</script>
<table class="layui-hide" id="ID-table-demo-data"></table>
<script src="./src/layui.js"></script>
<script src="./translate.service.js"></script>
<script>


var table;
layui.use('table', function(){
  table = layui.table;


  request.post(domain+'admin/cache/getCacheTextList.json', {token:'GA_A-BCIOXDIBS40D1EKLV5ILKCPWE4YUT5CX8AY98X',originalText:'yes'}, function(result){
    console.log(result);
    
    for(var i=0; i < result.list.length; i++){
      for(var key in result.list[i]){
        if(key.indexOf('to_') == 0 && result.list[i][key].length > 0){
          console.log(key);
          if(typeof(result.list[i]['translateResult']) == 'undefined'){
            result.list[i]['translateResult'] = [];
          }
          result.list[i]['translateResult'].push({'language':key.replace('to_',''), 'text':result.list[i][key]});
        }
        

        //将 addtime的 时间戳转为 2025-12-12 23:23:23 这种的时间显示
        result.list[i]['addtime'] = '2025-12-12 23:23:23';
      }
    }
    console.log(result);


    // table.render({
    //   elem: '#ID-table-demo-data',
    //   data:result.list
    // }); 
      

    // 已知数据渲染
    var inst = table.render({
      elem: '#ID-table-demo-data',
      cols: [[ //标题栏
        {field: 'text', title: '翻译前的原文本', width: 300, sort: true},
        {field: 'domain', title: '域名/key', width: 120},
        {field: 'addtime', title: '初次翻译时间', minWidth: 160},
        {field: 'translateResult', title: '翻译结果', width: 300, templet: '#translate-result-td'}
      ]],
      data: result.list,
      skin: 'line', // 表格风格
      //even: true,
      page: true, // 是否显示分页
      limit: 200 // 每页默认显示的数量
    });




  });

  
});


/*
  编辑某条翻译的结果
  id 列表中某个tr行的hash
  language 编辑的是哪个语言的译文，传入如  english
  text 编辑的译文内容
*/
function editTranslateText(id, language, text){
  //打开编辑窗口
}


</script>
</body>
</html>
